<script src="../../src/jquery-1.4.4-binary-ajax.js"></script>
<script src="../../src/jdataview.js"></script>

<style>
textarea { width: 80%; height: 300px; }
</style>
<body></body>
<script>
function tar(data) {
	// Make a view on the data
	var view = new jDataView(data);

	while (view.tell() < view.length) {
		// Parse the file meta data
		var metadata = {
			name: view.getString(100).replace(/\0+$/, ''),
			mode: parseInt(view.getString(8), 8),
			owner: parseInt(view.getString(8), 8),
			group: parseInt(view.getString(8), 8),
			size: parseInt(view.getString(12), 8),
			modtime: parseInt(view.getString(12), 8),
			checksum: parseInt(view.getString(8), 8),
			link: view.getChar(),
			name_linked: view.getString(100).replace(/\0+$/, ''),
			ustar: view.getString(6),
			ustar_version: parseInt(view.getString(2), 8),
			owner_name: view.getString(32).replace(/\0+$/, ''),
			group_name: view.getString(32).replace(/\0+$/, ''),
			device: [parseInt(view.getString(8), 8), parseInt(view.getString(8), 8)],
			name_prefix: view.getString(155).replace(/\0+$/, '')
		};

		// Padding
		if (view.tell() % 512 !== 0) {
			view.getString(512 - (view.tell() % 512));
		}
		
		// Get the file
		var content = view.getString(metadata.size);

		// Padding
		if (view.tell() % 512 != 0) {
			view.getString(512 - (view.tell() % 512));
		}
		
		// Print the file
		$('body').append($('<pre></pre>').html(JSON.stringify(metadata, null, '  ')));
		if (metadata.size) {
			$('body').append($('<textarea></textarea>').val(content));
		}
	}
}

// Download the file
$.get('jquery.tar', tar, 'binary');

</script>